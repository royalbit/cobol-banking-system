openapi: 3.0.3
info:
  title: Java Banking System API
  description: |
    REST API for the Java Banking System - a full-stack banking demo
    built with Spring Boot + Vue 3 + Tailwind CSS.

    ðŸ¤– Built with [RoyalBit Asimov](https://github.com/royalbit/asimov)
  version: 1.2.0
  contact:
    name: RoyalBit
    url: https://github.com/royalbit/cobol-banking-system
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:8080/api
    description: Local development
  - url: http://localhost:3000/api
    description: Docker (via Nginx proxy)

tags:
  - name: Accounts
    description: Account management operations
  - name: Transactions
    description: Transaction operations and history

paths:
  /accounts:
    get:
      tags: [Accounts]
      summary: List all accounts
      operationId: getAllAccounts
      responses:
        '200':
          description: List of accounts
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Account'

    post:
      tags: [Accounts]
      summary: Create new account
      operationId: createAccount
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAccountRequest'
      responses:
        '201':
          description: Account created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Account'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /accounts/{accountId}:
    get:
      tags: [Accounts]
      summary: Get account by ID
      operationId: getAccount
      parameters:
        - $ref: '#/components/parameters/AccountId'
      responses:
        '200':
          description: Account details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Account'
        '404':
          description: Account not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags: [Accounts]
      summary: Close account
      operationId: deleteAccount
      parameters:
        - $ref: '#/components/parameters/AccountId'
      responses:
        '200':
          description: Account closed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Account'
        '404':
          description: Account not found

  /accounts/{accountId}/deposit:
    post:
      tags: [Transactions]
      summary: Deposit funds
      operationId: deposit
      parameters:
        - $ref: '#/components/parameters/AccountId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TransactionRequest'
      responses:
        '200':
          description: Deposit successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionResponse'
        '404':
          description: Account not found
        '400':
          description: Invalid amount

  /accounts/{accountId}/withdraw:
    post:
      tags: [Transactions]
      summary: Withdraw funds
      operationId: withdraw
      parameters:
        - $ref: '#/components/parameters/AccountId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TransactionRequest'
      responses:
        '200':
          description: Withdrawal successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TransactionResponse'
        '400':
          description: Insufficient funds
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Account not found

  /accounts/apply-interest:
    post:
      tags: [Accounts]
      summary: Apply 2% interest to all savings accounts
      operationId: applyInterest
      responses:
        '200':
          description: Interest applied
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Interest applied to 3 savings accounts"
                  accountsUpdated:
                    type: integer
                    example: 3

  /accounts/{accountId}/transactions:
    get:
      tags: [Transactions]
      summary: Get transaction history
      operationId: getTransactions
      parameters:
        - $ref: '#/components/parameters/AccountId'
      responses:
        '200':
          description: Transaction list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Transaction'
        '404':
          description: Account not found

  /accounts/{accountId}/transactions/mini-statement:
    get:
      tags: [Transactions]
      summary: Get last 5 transactions
      operationId: getMiniStatement
      parameters:
        - $ref: '#/components/parameters/AccountId'
      responses:
        '200':
          description: Mini statement (last 5 transactions)
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Transaction'
                maxItems: 5
        '404':
          description: Account not found

components:
  parameters:
    AccountId:
      name: accountId
      in: path
      required: true
      description: Account ID (max 10 characters)
      schema:
        type: string
        maxLength: 10
        example: "ACC001"

  schemas:
    Account:
      type: object
      properties:
        accountId:
          type: string
          maxLength: 10
          example: "ACC001"
        customerName:
          type: string
          maxLength: 30
          example: "Alice Johnson"
        balance:
          type: number
          format: decimal
          example: 5650.00
        accountType:
          $ref: '#/components/schemas/AccountType'
        status:
          $ref: '#/components/schemas/AccountStatus'

    CreateAccountRequest:
      type: object
      required:
        - accountId
        - customerName
        - accountType
      properties:
        accountId:
          type: string
          maxLength: 10
          example: "ACC006"
        customerName:
          type: string
          maxLength: 30
          example: "New Customer"
        initialBalance:
          type: number
          format: decimal
          default: 0
          example: 1000.00
        accountType:
          $ref: '#/components/schemas/AccountType'

    TransactionRequest:
      type: object
      required:
        - amount
      properties:
        amount:
          type: number
          format: decimal
          minimum: 0.01
          example: 500.00

    TransactionResponse:
      type: object
      properties:
        accountId:
          type: string
          example: "ACC001"
        balance:
          type: number
          format: decimal
          example: 6150.00
        message:
          type: string
          example: "Deposited $500.00"

    Transaction:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        accountId:
          type: string
          example: "ACC001"
        type:
          $ref: '#/components/schemas/TransactionType'
        typeLabel:
          type: string
          example: "Deposit"
        amount:
          type: number
          format: decimal
          example: 500.00
        date:
          type: string
          format: date
          example: "2024-12-01"
        time:
          type: string
          example: "14:30:00"

    AccountType:
      type: string
      enum: [SAVINGS, CHECKING]
      example: "SAVINGS"

    AccountStatus:
      type: string
      enum: [ACTIVE, INACTIVE]
      example: "ACTIVE"

    TransactionType:
      type: string
      enum: [DEPOSIT, WITHDRAWAL, INTEREST]
      example: "DEPOSIT"

    Error:
      type: object
      properties:
        error:
          type: string
          example: "Insufficient funds"
        message:
          type: string
          example: "Cannot withdraw $1000.00 from balance of $500.00"
        timestamp:
          type: string
          format: date-time
